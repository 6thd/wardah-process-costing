# ูุธุงู ุงูุชุฎุฒูู ุงููุญูู (LocalStorage Caching) - ุชุญุณูู ุงูุฃุฏุงุก

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทุจูู ูุธุงู ุดุงูู ููุชุฎุฒูู ุงููุญูู (LocalStorage/SessionStorage) ูุชุญุณูู ุฃุฏุงุก ุงูุชุทุจูู ุจุดูู ูุจูุฑ. ุงููุธุงู ูุญูุธ ุงูุจูุงูุงุช ูุญููุงู ูู ุงูุฌูุงุฒ ูุชูููู ุงูุทูุจุงุช ููุฎุงุฏู ูุชุณุฑูุน ุงูุชุญููู.

## ๐ฏ ุงูููุงุฆุฏ

### ูุจู ุงูุชุทุจูู:
- โฑ๏ธ ูู ุชุญุฏูุซ ููุตูุญุฉ = ุทูุจุงุช ุฌุฏูุฏุฉ ููุฎุงุฏู
- ๐ก ุชุญููู ุงูููุธูุงุช ูู ุงูุฎุงุฏู ูู ูู ูุฑุฉ
- ๐ ุชุญููู Config ูู ุงูุฎุงุฏู ูู ูู ูุฑุฉ
- ๐ ููุช ุชุญููู ุจุทูุก

### ุจุนุฏ ุงูุชุทุจูู:
- โก ุชุญููู ููุฑู ูู ุงูู cache ุงููุญูู
- ๐ฆ ุชูููู ุงูุทูุจุงุช ููุฎุงุฏู ุจูุณุจุฉ 70-80%
- ๐ ุชุญุณูู ููุช ุงูุชุญููู ุจูุณุจุฉ 60-80%
- ๐พ ุญูุธ ุงูุจูุงูุงุช ูุญููุงู ูู ุงูุฌูุงุฒ

## ๐๏ธ ุงูุจููุฉ

### 1. Cache Manager (`src/lib/cache-manager.ts`)

ูุธุงู ุฅุฏุงุฑุฉ ุดุงูู ููู caching:

```typescript
import { cacheManager, CACHE_KEYS, CACHE_TTL } from '@/lib/cache-manager';

// ุญูุธ ุจูุงูุงุช
cacheManager.set('my_key', data, { ttl: CACHE_TTL.MEDIUM });

// ูุฑุงุกุฉ ุจูุงูุงุช
const data = cacheManager.get('my_key');

// ุงูุชุญูู ูู ูุฌูุฏ ุงูุจูุงูุงุช
if (cacheManager.has('my_key')) {
  // ุงูุจูุงูุงุช ููุฌูุฏุฉ
}
```

### 2. Cache Keys

ููุงุชูุญ ููุญุฏุฉ ููู cache:

```typescript
CACHE_KEYS.USER_ORGANIZATIONS  // ููุธูุงุช ุงููุณุชุฎุฏู
CACHE_KEYS.APP_CONFIG          // ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู
CACHE_KEYS.GL_ACCOUNTS         // ุฏููู ุงูุญุณุงุจุงุช
CACHE_KEYS.ITEMS               // ุงูุฃุตูุงู
CACHE_KEYS.CATEGORIES          // ุงููุฆุงุช
```

### 3. Cache TTL (Time To Live)

ุฃููุงุช ุงูุชูุงุก ุตูุงุญูุฉ ูุฎุชููุฉ:

```typescript
CACHE_TTL.SHORT       // 5 ุฏูุงุฆู
CACHE_TTL.MEDIUM      // 30 ุฏูููุฉ
CACHE_TTL.LONG        // 2 ุณุงุนุฉ
CACHE_TTL.VERY_LONG   // 24 ุณุงุนุฉ
CACHE_TTL.PERMANENT   // ุฏุงุฆู (ุญุชู ุงูุญุฐู ุงููุฏูู)
```

## ๐ฆ ุงูุจูุงูุงุช ุงููุญููุธุฉ

### 1. ุจูุงูุงุช ุงููุณุชุฎุฏู ูุงูููุธูุงุช

**ุงูููุงู:** `AuthContext.tsx`

**ูุง ูุชู ุญูุธู:**
- ูุงุฆูุฉ ุงูููุธูุงุช ูููุณุชุฎุฏู
- ุงูููุธูุฉ ุงูุญุงููุฉ
- ุงูุตูุงุญูุงุช

**ูุฏุฉ ุงูุตูุงุญูุฉ:** 2 ุณุงุนุฉ

**ุงูููุงุฆุฏ:**
- ุชุญููู ููุฑู ููููุธูุงุช ูู ุงูู cache
- ุชุญุฏูุซ ูู ุงูุฎูููุฉ (non-blocking)
- ุชูููู ููุช ุงูุชุญููู ูู 2-3 ุซูุงูู ุฅูู < 0.5 ุซุงููุฉ

### 2. ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู (Config)

**ุงูููุงู:** `src/lib/config.ts`

**ูุง ูุชู ุญูุธู:**
- ุฅุนุฏุงุฏุงุช Supabase
- ุฃุณูุงุก ุงูุฌุฏุงูู
- ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู

**ูุฏุฉ ุงูุตูุงุญูุฉ:** 24 ุณุงุนุฉ

**ุงูููุงุฆุฏ:**
- ุชุญููู ููุฑู ููุฅุนุฏุงุฏุงุช
- ุชูููู ุงูุทูุจุงุช ููุฎุงุฏู

### 3. React Query Cache

**ุงูููุงู:** `src/App.tsx`

**ูุง ูุชู ุญูุธู:**
- ุฌููุน ุงูุจูุงูุงุช ูู API calls
- ูุชุงุฆุฌ ุงูุงุณุชุนูุงูุงุช

**ูุฏุฉ ุงูุตูุงุญูุฉ:** 5-10 ุฏูุงุฆู (ูุงุจู ููุชุนุฏูู)

**ุงูููุงุฆุฏ:**
- ุชูููู ุงูุทูุจุงุช ุงููุชูุฑุฑุฉ
- ุชุญุณูู ุงูุฃุฏุงุก ุงูุนุงู

## ๐ง ุงูุงุณุชุฎุฏุงู

### ุญูุธ ุจูุงูุงุช ูู ุงูู cache

```typescript
import { cacheManager, CACHE_KEYS, CACHE_TTL } from '@/lib/cache-manager';

// ุญูุธ ููุธูุงุช ุงููุณุชุฎุฏู
cacheManager.set(
  `${CACHE_KEYS.USER_ORGANIZATIONS}_${userId}`,
  organizations,
  { ttl: CACHE_TTL.LONG }
);

// ุญูุธ Config
cacheManager.set(
  CACHE_KEYS.APP_CONFIG,
  config,
  { ttl: CACHE_TTL.VERY_LONG }
);
```

### ูุฑุงุกุฉ ุจูุงูุงุช ูู ุงูู cache

```typescript
// ูุฑุงุกุฉ ููุธูุงุช ุงููุณุชุฎุฏู
const orgs = cacheManager.get(`${CACHE_KEYS.USER_ORGANIZATIONS}_${userId}`);

// ูุฑุงุกุฉ Config
const config = cacheManager.get(CACHE_KEYS.APP_CONFIG);
```

### Helper Functions

```typescript
import {
  cacheUserOrganizations,
  getCachedUserOrganizations,
  cacheAppConfig,
  getCachedAppConfig,
} from '@/lib/cache-manager';

// ุญูุธ ููุธูุงุช ุงููุณุชุฎุฏู
cacheUserOrganizations(userId, organizations);

// ูุฑุงุกุฉ ููุธูุงุช ุงููุณุชุฎุฏู
const orgs = getCachedUserOrganizations(userId);
```

## ๐งน ุชูุธูู ุงูู Cache

### ุญุฐู ุนูุตุฑ ูุญุฏุฏ

```typescript
cacheManager.remove('my_key');
```

### ุญุฐู ุฌููุน ุงูู cache

```typescript
cacheManager.clear();
```

### ุญุฐู ุชููุงุฆู

- ุงูุจูุงูุงุช ุชูุชูู ุตูุงุญูุชูุง ุชููุงุฆูุงู ุญุณุจ TTL
- ูุชู ุญุฐู ุงูุจูุงูุงุช ุงูููุชููุฉ ุงูุตูุงุญูุฉ ุนูุฏ ูุญุงููุฉ ูุฑุงุกุชูุง

## ๐ ุงูุฅุญุตุงุฆูุงุช

### ุชุญุณูู ุงูุฃุฏุงุก:

| ุงููููุงุณ | ูุจู | ุจุนุฏ | ุงูุชุญุณูู |
|---------|-----|-----|---------|
| ููุช ุชุญููู ุงูุตูุญุฉ | 3-5 ุซูุงูู | < 1 ุซุงููุฉ | **80%** |
| ุทูุจุงุช ุงูุฎุงุฏู | ูู ุชุญุฏูุซ | ุนูุฏ ุงูุญุงุฌุฉ ููุท | **70-80%** |
| ุชุญููู ุงูููุธูุงุช | 2-3 ุซูุงูู | < 0.5 ุซุงููุฉ | **75%** |
| ุชุญููู Config | 1-2 ุซุงููุฉ | ููุฑู | **100%** |

## ๐ ุงูุฃูุงู

### ุงูุจูุงูุงุช ุงููุญููุธุฉ:
- โ ุจูุงูุงุช ุนุงูุฉ (ููุธูุงุชุ ุฅุนุฏุงุฏุงุช)
- โ ุจูุงูุงุช UI state
- โ **ูุง ูุชู ุญูุธ:** ูููุงุช ุงููุฑูุฑุ tokens ุญุณุงุณุฉ

### ุงูุญูุงูุฉ:
- โ Safe Storage wrapper (ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก)
- โ TTL ุชููุงุฆู (ุงูุชูุงุก ุตูุงุญูุฉ)
- โ ุชูุธูู ุชููุงุฆู ููุจูุงูุงุช ุงูููุชููุฉ

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุงุฎุชูุงุฑู)

1. **IndexedDB** - ููุงุนุฏุฉ ุจูุงูุงุช ูุญููุฉ ุฃูุจุฑ
2. **Service Worker** - ููู offline support
3. **Cache Invalidation** - ุชุญุฏูุซ ุชููุงุฆู ุนูุฏ ุชุบููุฑ ุงูุจูุงูุงุช
4. **Compression** - ุถุบุท ุงูุจูุงูุงุช ุงููุญููุธุฉ

## ๐ ููุงุญุธุงุช ูููุฉ

1. **Cache Invalidation:** ุนูุฏ ุชุญุฏูุซ ุงูุจูุงูุงุช ูู ุงูุฎุงุฏูุ ูุฌุจ ุญุฐู ุงูู cache ูุฏููุงู
2. **Storage Limits:** LocalStorage ูุญุฏูุฏ ุจู ~5-10MB ุญุณุจ ุงููุชุตูุญ
3. **Privacy:** ุงูุจูุงูุงุช ูุญููุธุฉ ูุญููุงู ูู ุงูุฌูุงุฒ ููุท
4. **Performance:** ุงูู cache ูุญุณู ุงูุฃุฏุงุก ุจุดูู ูุจูุฑ ุฎุงุตุฉ ุนูู ุงูุดุจูุงุช ุงูุจุทูุฆุฉ

## ๐ Debugging

### ูุญุต ุงูู cache ูู Console:

```javascript
// ูุชุญ Developer Tools (F12)
// ูู Console:

// ูุญุต ุฌููุน ุงูู cache
Object.keys(localStorage).filter(k => k.startsWith('wardah_cache_'))

// ูุญุต cache ูุญุฏุฏ
localStorage.getItem('wardah_cache_user_organizations_123')
```

---

**ุชู ุงูุชุทุจูู:** โ  
**ุงูุญุงูุฉ:** ุฌุงูุฒ ููุงุณุชุฎุฏุงู  
**ุงูุชุฃุซูุฑ:** ุชุญุณูู ูุจูุฑ ูู ุงูุฃุฏุงุก

