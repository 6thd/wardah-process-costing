# โ ุชุทุจูู HIBP Password Validation - ููุฎุต ุงูุชูููุฐ

**ุงูุชุงุฑูุฎ:** 2025-01-XX  
**ุงูุญุงูุฉ:** โ ููุชูู

---

## ๐ฏ **ุงููุฏู**

ุชุทุจูู ุญู ุจุฏูู ูุฌุงูู ููุชุญูู ูู ูููุงุช ุงููุฑูุฑ ุงููุณุฑุจุฉ (Leaked Password Protection) ุจุงุณุชุฎุฏุงู Have I Been Pwned APIุ ุจุฏูุงู ูู Supabase Pro plan ($25/ุดูุฑ).

---

## โ **ูุง ุชู ุฅูุฌุงุฒู**

### **1. ุชุซุจูุช ุงูููุชุจุฉ**
```bash
npm install hibp
```
โ **ุชู ุจูุฌุงุญ**

### **2. ุฅูุดุงุก Password Validator**
**ุงูููู:** `src/lib/auth/password-validator.ts`

**ุงููุธุงุฆู:**
- โ `validatePasswordNotLeaked()` - ุงูุชุญูู ูู ูููุฉ ุงููุฑูุฑ ุงููุณุฑุจุฉ
- โ `validatePassword()` - ุงูุชุญูู ุงููุงูู (strength + leaked)
- โ `validatePasswordStrength()` - ุงูุชุญูู ุงูุณุฑูุน (strength only)

### **3. ุงูุชูุงูู ูู Sign Up Form**
**ุงูููู:** `src/pages/signup.tsx`

**ุงูููุฒุงุช ุงููุถุงูุฉ:**
- โ Real-time password strength validation
- โ Debounced HIBP check (ุจุนุฏ 1 ุซุงููุฉ ูู ุชููู ุงููุชุงุจุฉ)
- โ ุนุฑุถ ุงูุฃุฎุทุงุก ูููุณุชุฎุฏู ุจุงูุนุฑุจูุฉ
- โ ุฑุณุงูุฉ ูุฌุงุญ ุนูุฏ ุงุฎุชูุงุฑ ูููุฉ ูุฑูุฑ ุขููุฉ
- โ Loading indicator ุฃุซูุงุก ุงูุชุญูู

---

## ๐ง **ููู ูุนูู**

### **1. Real-time Validation (Strength Only)**
ุนูุฏ ูุชุงุจุฉ ูููุฉ ุงููุฑูุฑ:
- โ ูุญุต ููุฑู ููู strength (length, uppercase, lowercase, numbers, special chars)
- โ ุนุฑุถ ุงูุฃุฎุทุงุก ููุฑุงู

### **2. Debounced HIBP Check**
ุจุนุฏ ุชููู ุงููุณุชุฎุฏู ุนู ุงููุชุงุจุฉ ููุฏุฉ 1 ุซุงููุฉ:
- โ ูุญุต ูููุฉ ุงููุฑูุฑ ุถุฏ HIBP API
- โ ุนุฑุถ ุชุญุฐูุฑ ุฅุฐุง ูุงูุช ูุณุฑุจุฉ
- โ ุนุฑุถ ุฑุณุงูุฉ ูุฌุงุญ ุฅุฐุง ูุงูุช ุขููุฉ

### **3. Full Validation on Submit**
ุนูุฏ ุงูุถุบุท ุนูู "ุฅูุดุงุก ุงูุญุณุงุจ":
- โ ูุญุต ูุงูู ููู strength
- โ ูุญุต HIBP API
- โ ููุน ุงูุชุณุฌูู ุฅุฐุง ูุงูุช ูููุฉ ุงููุฑูุฑ ุบูุฑ ุขููุฉ

---

## ๐ **ุงูููุฒุงุช**

### **โ ุงูุฃูุงู**
- โ ููุน ุงุณุชุฎุฏุงู ูููุงุช ุงููุฑูุฑ ุงููุณุฑุจุฉ
- โ ุงูุชุญูู ูู ููุฉ ูููุฉ ุงููุฑูุฑ
- โ ุฑุณุงุฆู ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ

### **โ ุงูุฃุฏุงุก**
- โ Debouncing ูุชูููู API calls
- โ Real-time validation ููู strength (ุจุฏูู API)
- โ Fail open (ุฅุฐุง ูุดู APIุ ูุณูุญ ุจูููุฉ ุงููุฑูุฑ)

### **โ ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู**
- โ ุฑุณุงุฆู ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ
- โ Loading indicator
- โ ุฑุณุงูุฉ ูุฌุงุญ ุนูุฏ ุงุฎุชูุงุฑ ูููุฉ ูุฑูุฑ ุขููุฉ
- โ ุฃุฎุทุงุก ูุญุฏุฏุฉ ููู ูุดููุฉ

---

## ๐ **ุฃูุซูุฉ ุงูุฑุณุงุฆู**

### **ุฃุฎุทุงุก Strength:**
- "ูููุฉ ุงููุฑูุฑ ูุฌุจ ุฃู ุชููู 8 ุฃุญุฑู ุนูู ุงูุฃูู"
- "ูููุฉ ุงููุฑูุฑ ูุฌุจ ุฃู ุชุญุชูู ุนูู ุญุฑู ูุจูุฑ ูุงุญุฏ ุนูู ุงูุฃูู"
- "ูููุฉ ุงููุฑูุฑ ูุฌุจ ุฃู ุชุญุชูู ุนูู ุญุฑู ุตุบูุฑ ูุงุญุฏ ุนูู ุงูุฃูู"
- "ูููุฉ ุงููุฑูุฑ ูุฌุจ ุฃู ุชุญุชูู ุนูู ุฑูู ูุงุญุฏ ุนูู ุงูุฃูู"
- "ูููุฉ ุงููุฑูุฑ ูุฌุจ ุฃู ุชุญุชูู ุนูู ุฑูุฒ ุฎุงุต ูุงุญุฏ ุนูู ุงูุฃูู"

### **ุฃุฎุทุงุก Leaked Password:**
- "โ๏ธ ูุฐู ูููุฉ ุงููุฑูุฑ ุชู ุงูุนุซูุฑ ุนูููุง ูู X ุฎุฑู ุจูุงูุงุช. ูุฑุฌู ุงุฎุชูุงุฑ ูููุฉ ูุฑูุฑ ุฃุฎุฑู."

### **ุฑุณุงูุฉ ุงููุฌุงุญ:**
- "โ ูููุฉ ุงููุฑูุฑ ุขููุฉ"

---

## ๐ **ุงูููุงุฑูุฉ**

| ุงูููุฒุฉ | Supabase Pro | HIBP (Free) |
|--------|--------------|-------------|
| **ุงูุชูููุฉ** | $25/ุดูุฑ | $0 |
| **ุงูุชูุงูู** | ุชููุงุฆู | ูุฏูู โ |
| **API Limits** | ุบูุฑ ูุญุฏูุฏ | ูุญุฏูุฏ (ููู ูุงูู) |
| **ุงูุณุฑุนุฉ** | ุณุฑูุน ุฌุฏุงู | ุณุฑูุน โ |
| **ุงูููุซูููุฉ** | ุนุงููุฉ | ุฌูุฏุฉ โ |

---

## ๐ **ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุงุฎุชูุงุฑู)**

### **1. ุชุทุจูู ูู Change Password Form**
ุฅุฐุง ูุงู ููุงู Change Password formุ ูููู ุชุทุจูู ููุณ ุงูุญู.

### **2. ุฅุถุงูุฉ Caching (ุงุฎุชูุงุฑู)**
ูุชูููู API callsุ ูููู ุฅุถุงูุฉ caching:

```typescript
const passwordCache = new Map<string, { isSafe: boolean; timestamp: number }>();
```

### **3. Fail Closed (ุงุฎุชูุงุฑู)**
ููุฅูุชุงุฌุ ูููู ุชุบููุฑ Fail Open ุฅูู Fail Closed:

```typescript
// Fail closed: ุฅุฐุง ูุดู APIุ ูุฑูุถ ูููุฉ ุงููุฑูุฑ
return { isSafe: false };
```

---

## โ **Checklist ุงูุชูููุฐ**

- [x] โ ุชุซุจูุช `hibp` library
- [x] โ ุฅูุดุงุก `password-validator.ts`
- [x] โ ุชุทุจูู ูู Sign Up form
- [x] โ Real-time validation
- [x] โ Debounced HIBP check
- [x] โ ุนุฑุถ ุงูุฃุฎุทุงุก ุจุงูุนุฑุจูุฉ
- [x] โ Loading indicator
- [ ] โณ ุชุทุจูู ูู Change Password form (ุฅุฐุง ูุงู ููุฌูุฏุงู)
- [ ] โณ ุฅุถุงูุฉ caching (ุงุฎุชูุงุฑู)
- [ ] โณ ุงุฎุชุจุงุฑ ุงูุชูุงูู

---

## ๐ **ุงููุชุงุฆุฌ**

### **ูุจู:**
- โ ูุง ููุฌุฏ ุชุญูู ูู ูููุงุช ุงููุฑูุฑ ุงููุณุฑุจุฉ
- โ ูุญุชุงุฌ Supabase Pro ($25/ุดูุฑ)

### **ุจุนุฏ:**
- โ ุชุญูู ูู ูููุงุช ุงููุฑูุฑ ุงููุณุฑุจุฉ (ูุฌุงูู)
- โ Real-time validation
- โ ุฑุณุงุฆู ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ
- โ ุชูููุฉ: $0

---

## ๐ **ุงููููุงุช ุฐุงุช ุงูุตูุฉ**

- `src/lib/auth/password-validator.ts` โ
- `src/pages/signup.tsx` โ
- `docs/security/PASSWORD_VALIDATION_ALTERNATIVE.md` โ
- `package.json` (hibp dependency) โ

---

## ๐ **ููุงุญุธุงุช**

1. **API Limits:** HIBP API ูุฌุงูู ููู ูุญุฏูุฏ. Debouncing ูููู ุงูุทูุจุงุช.
2. **Fail Open:** ุงูุญู ุงูุญุงูู ูุณูุญ ุจูููุฉ ุงููุฑูุฑ ุฅุฐุง ูุดู API (ููุชููุฑ). ูููู ุชุบููุฑู ูู Fail Closed ููุฅูุชุงุฌ.
3. **Privacy:** HIBP ูุณุชุฎุฏู k-anonymity (ุขูู - ูุง ูุชู ุฅุฑุณุงู ูููุฉ ุงููุฑูุฑ ูุงููุฉ).

---

**ุงูุญุงูุฉ:** โ ููุชูู ูุฌุงูุฒ ููุงุณุชุฎุฏุงู  
**ุงูุชูููุฉ:** $0  
**ุงููุงุฆุฏุฉ:** ุญูุงูุฉ ูููุงุช ุงููุฑูุฑ ุจุฏูู ุชูููุฉ ุฅุถุงููุฉ

